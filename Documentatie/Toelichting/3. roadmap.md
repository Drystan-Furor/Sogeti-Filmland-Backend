### **ğŸ“Œ Bouwstrategie voor de Filmland Back-End (Spring Boot & JWT)**

Tristan's doel is om een schaalbare, veilige en goed gestructureerde Spring Boot API te bouwen die voldoet aan de Filmland-opdracht. Hieronder een **strategisch plan** om dit efficiÃ«nt op te zetten.

---

## **ğŸ”· 1. Algemene Architectuur Keuzes**
âœ… **Spring Boot** als framework voor snelle ontwikkeling.  
âœ… **JWT Authenticatie** in plaats van sessies voor een stateless backend.  
âœ… **H2 in-memory database** voor eenvoudige data-opslag tijdens de ontwikkeling.  
âœ… **RESTful API Design** met duidelijke endpoints voor de vereiste functionaliteiten.  
âœ… **Test-driven development (TDD)**: Eerst testen schrijven, dan implementeren.

**ğŸŒŸ Belangrijk:** Code wordt in logische lagen gescheiden:
- **Controller Layer** (REST APIâ€™s)
- **Service Layer** (Business Logica)
- **Repository Layer** (Database interactie)
- **Security Layer** (JWT & Authenticatie)

---

## **ğŸ”· 2. Stappenplan per Functionaliteit**
Om de opdracht gestructureerd te bouwen, volgen we de **member stories** uit de opdracht.

### **ğŸ”¹ Stap 1: Basisproject en Authenticatie**
ğŸ“Œ **Doel:** Gebruikers kunnen inloggen en een JWT-token ontvangen.  
âœ… **Spring Boot project opzetten** (al gedaan).  
âœ… **Spring Security configureren** met JWT-token.  
âœ… **Login-endpoint maken** (`POST /authenticate`).  
âœ… **JWT generatie en validatie implementeren**.  
âœ… **Security filter maken** zodat alleen geauthenticeerde gebruikers de API kunnen gebruiken.  
âœ… **Tests schrijven** voor login en JWT-validatie.

**ğŸ› ï¸ Betrokken Klassen:**
- `AuthController` (verzorgt login)
- `JwtUtil` (genereert en valideert JWT)
- `SecurityConfig` (beveiliging via JWT)
- `JwtRequestFilter` (filtert inkomende requests)

---

### **ğŸ”¹ Stap 2: Gebruikers kunnen categorieÃ«n ophalen**
ğŸ“Œ **Doel:** Gebruikers kunnen beschikbare en geabonneerde categorieÃ«n ophalen.  
âœ… **Categorie model maken** (`Category`).  
âœ… **Repository maken** (`CategoryRepository`).  
âœ… **Service maken** (`CategoryService`).  
âœ… **GET `/categories` endpoint maken**.  
âœ… **Authenticatie vereist maken (JWT-token nodig in header)**.  
âœ… **Tests schrijven** voor ophalen categorieÃ«n.

**ğŸ› ï¸ Betrokken Klassen:**
- `CategoryController`
- `CategoryService`
- `CategoryRepository`
- `Category` (modelklasse)

---

### **ğŸ”¹ Stap 3: Abonneren op een categorie**
ğŸ“Œ **Doel:** Gebruikers kunnen zich abonneren op een categorie.  
âœ… **POST `/subscribe` endpoint maken**.  
âœ… **Business regels toevoegen (abonnement kan niet dubbel worden afgesloten)**.  
âœ… **Eerste maand gratis implementeren**.  
âœ… **Tests schrijven** voor abonnement functionaliteit.

**ğŸ› ï¸ Betrokken Klassen:**
- `SubscriptionController`
- `SubscriptionService`
- `SubscriptionRepository`
- `Subscription` (modelklasse)

---

### **ğŸ”¹ Stap 4: Abonnementen delen**
ğŸ“Œ **Doel:** Een gebruiker kan een abonnement delen met een ander.  
âœ… **POST `/share-subscription` endpoint maken**.  
âœ… **Business regels toevoegen (kosten en beschikbare content verdelen)**.  
âœ… **Authenticatie verplicht maken**.  
âœ… **Tests schrijven voor delen van abonnementen.**

**ğŸ› ï¸ Betrokken Klassen:**
- `SubscriptionController`
- `SubscriptionService`
- `SubscriptionRepository`
- `UserRepository` (om bestaande gebruiker te controleren)

---

### **ğŸ”¹ Stap 5: Betalingen en Scheduler**
ğŸ“Œ **Doel:** Betalingen beheren en abonnementen automatisch verlengen.  
âœ… **Scheduler toevoegen met `@Scheduled` voor maandelijkse betalingen**.  
âœ… **Automatisch facturen genereren**.  
âœ… **Tests schrijven voor betaling functionaliteit**.

**ğŸ› ï¸ Betrokken Klassen:**
- `PaymentScheduler`
- `PaymentService`
- `SubscriptionService`

---

## **ğŸ”· 3. Teststrategie**
### **ğŸ”¹ Unit Tests**
- Gebruik **JUnit & Mockito** om services afzonderlijk te testen.
- Test **JWT authenticatie, database queries en business logica**.

### **ğŸ”¹ Integration Tests**
- Gebruik **Spring Boot Test** met een echte database (H2).
- Test volledige API-flows met **MockMvc**.

### **ğŸ”¹ Security Tests**
- Gebruik **spring-security-test** om te valideren of endpoints goed beschermd zijn.

**ğŸ“Œ Doel:** Minimaal 80% test coverage op de service laag.

---

## **ğŸ”· 4. Deployment Strategie**
1. **Docker Container maken** ğŸ³
    - `Dockerfile` aanmaken met Spring Boot + H2 database.
    - Docker-compose configureren voor testomgeving.

2. **CI/CD Pipeline met GitHub Actions** ğŸ”„
    - **Build & Test automatisch uitvoeren** bij elke commit.
    - Automatisch pushen naar **Render** of een andere cloud-hosting.

---

## **ğŸ”· 5. Project Structuur (Maven)**
```
ğŸ“‚ filmland-backend
 â”£ ğŸ“‚ src/main/java/sogeti/filmland
 â”ƒ â”£ ğŸ“‚ controller       # REST API Controllers
 â”ƒ â”£ ğŸ“‚ service          # Business Logica
 â”ƒ â”£ ğŸ“‚ repository       # Database Access (JPA Repositories)
 â”ƒ â”£ ğŸ“‚ security         # JWT & Spring Security
 â”ƒ â”£ ğŸ“‚ model            # Entiteiten (Category, User, Subscription)
 â”ƒ â”£ ğŸ“œ FilmlandApplication.java  # Hoofdklasse
 â”£ ğŸ“‚ src/test/java      # Unit & Integration Tests
 â”£ ğŸ“œ pom.xml            # Maven Dependencies
 â”£ ğŸ“œ application.yml     # Configuratie
 â”£ ğŸ“œ Dockerfile         # Docker Configuratie
 â”£ ğŸ“œ .github/workflows  # GitHub Actions (CI/CD)
 â”— ğŸ“œ .gitignore         # Git Ignore
```

---

## **ğŸ”· 6. Tijdsinschatting**
| **Stap**                         | **Tijd (uur)** |
|----------------------------------|--------------|
| ğŸ”¹ Project setup + GitHub CI/CD  | 2            |
| ğŸ”¹ JWT Authenticatie & Security  | 3            |
| ğŸ”¹ CategorieÃ«n ophalen           | 2            |
| ğŸ”¹ Abonneren op categorie        | 2            |
| ğŸ”¹ Abonnement delen              | 3            |
| ğŸ”¹ Betalingen & Scheduler        | 3            |
| ğŸ”¹ Unit en Integration Tests     | 4            |
| ğŸ”¹ Docker & Deployment           | 3            |
| **ğŸ“Œ Totaal**                     | **22 - 25 uur** |

---

## **ğŸ”· 7. Mogelijke Uitbreidingen (Na MVP)**
âœ… **Rate Limiting** met Spring Boot (voorkomen van misbruik van API).  
âœ… **Meer database-opties** zoals PostgreSQL in plaats van H2.  
âœ… **API Rate-Limiting** en **Logging met ELK-stack**.

---

## **âœ… Conclusie**
Tristan heeft nu een **duidelijke roadmap** voor het bouwen van Filmland. Dit plan helpt om **gefaseerd en efficiÃ«nt** de vereiste functionaliteiten te implementeren met **Spring Boot en JWT**.

ğŸ’¡ **Wat is de volgende stap?** Wil je beginnen met de **JWT-authenticatie**, of eerst de basis-API opzetten? ğŸš€